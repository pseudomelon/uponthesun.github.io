    <!DOCTYPE html>
    <html>
    <head>
    <script type="text/javascript">

    const NUM_PLAYERS = 8;
    const NUM_PACKS = 3;
    const CARDS_PER_PACK = 15;
    const DEFAULT_CUBE_FILE = "winstons_cube.txt";
    var cubeList;
    var packs;
    var playerPicks;
    var playerPickDivs;

    /* Variables for tracking the current state of the draft. All are 0-indexed. */
    // Current pack being drafted, i.e. a normal draft has 3 packs
    var currentPack;
    // Current pick in the pack.
    var currentPick;
    // The seat for which the user is making the pick for; the user makes the picks for every seat in the simulated draft.
    var currentSeat;

    initializeDefaultCube();

    /* Retrieve default cube file and initialize draft with it. */ 
    function initializeDefaultCube() {
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if(xhttp.readyState == 4 && xhttp.status==200) {
          console.log("responsetext: " + xhttp.responsetext);
          initialize(xhttp.responsetext);
        }
      }

      xhttp.open("GET", DEFAULT_CUBE_FILE);
      xhttp.send();
    }

    /* Initialize the draft with the given cube list. The list should be given as string of newline-separated card names.
     * Can be called multiple times; each time it is called, the entire draft will restart. */
    function initialize(rawCubeList) {
      packs = [];
      playerPicks = [];
      playerPickDivs = [];

      currentPack = 0;
      currentPick = 0;
      currentSeat = 0;

      cubeList = rawCubeList.split('\n');
      shuffleArray(cubeList);

      for (var i = 0; i < NUM_PLAYERS * NUM_PACKS; i++) {
      	var newPack = [];
      	for (var j = 0; j < CARDS_PER_PACK; j++) {
      		console.log("creating pack: " + cubeList[i * CARDS_PER_PACK + j]);
      		newPack.push(cubeList[i * CARDS_PER_PACK + j]);
      	}
      	packs.push(newPack);
      }

      document.getElementById("picksDisplay").innerHTML = "";
      for (var i = 0; i < NUM_PLAYERS; i++) {
      	playerPicks.push([]);
        var picksDiv = document.createElement("div");
        var picksLabel = document.createElement("p");
        picksLabel.appendChild(document.createTextNode(`Player ${i+1} Picks`));
        picksDiv.appendChild(picksLabel);
        toggleDisplay(picksDiv);

        playerPickDivs[i] = picksDiv;
        document.getElementById("picksDisplay").appendChild(picksDiv);
      }

      toggleDisplay(playerPickDivs[0]);
      displayPack(packs[0]);
    }

    function displayPack(pack) {
      document.getElementById("display").innerHTML = "";
      pack.forEach(function(cardName) {
        var imageTag = createCardImageTag(cardName);
        imageTag.addEventListener("click", function() {
          addToPicks(cardName);
          imageTag.remove();
        });

        document.getElementById("display").appendChild(imageTag);
      });
    }

    function addToPicks(pickedCard) {
      console.log(`P${currentPack+1}P${currentPick+1} Player ${currentSeat+1} picked: ${pickedCard}`);

      var imageTag = createCardImageTag(pickedCard);
      playerPickDivs[currentSeat].appendChild(imageTag);
      playerPicks[currentSeat].push(pickedCard);

      removeFromArray(getActivePack(), pickedCard);
      toggleDisplay(playerPickDivs[currentSeat]);

      currentSeat++;
      if (currentSeat == NUM_PLAYERS) {
      	currentPick++;
      	currentSeat = 0;
      }
      if (currentPick == CARDS_PER_PACK) {
      	currentPack++;
      	currentPick = 0;
      }

      toggleDisplay(playerPickDivs[currentSeat]);
      displayPack(getActivePack());
    }

    function getActivePack() {
      console.log(`currentPack: ${currentPack} currentSeat : ${currentSeat} currentPick: ${currentPick}`);
      var direction = (currentPack % 2 == 0) ? 1 : -1;
      var pickOffset = direction * currentPick;
      var index = (NUM_PLAYERS * currentPack) + mod(currentSeat + pickOffset, NUM_PLAYERS);
      console.log("activePack:" + index);
      return packs[index];
    }

    function toggleDisplay(element) {
      if(element.style.display !== 'none') {
        element.style.display = 'none';
      } else {
        element.style.display = 'block';
      }
    }

    function createCardImageTag(cardName) {
      var imageUrl = `http://gatherer.wizards.com/Handlers/Image.ashx?name=${cardName}&type=card`;

      var imageTag = document.createElement("img");
      imageTag.setAttribute("src", imageUrl);
      return imageTag;    
    }

    /* Version of modulus which always returns a positive value. */
    function mod(n, m) {
      return ((n % m) + m) % m;
    }

    /**
     * Randomize array element order in-place.
     * Using Durstenfeld shuffle algorithm.
     */
    function shuffleArray(array) {
        for (var i = array.length - 1; i > 0; i--) {
            var j = Math.floor(Math.random() * (i + 1));
            var temp = array[i];
            array[i] = array[j];
            array[j] = temp;
        }
        return array;
    }

    function removeFromArray(arr, value) {
      var index = arr.indexOf(value);
      if (index >= 0) {
        arr.splice(index, 1);
      }
    }

    function openFile(event) {
      var input = event.target;

      var reader = new FileReader();
      reader.onload = function(){
        initialize(reader.result);
      };
      reader.readAsText(input.files[0]);
    };

    </script>
    </head>
    <body>

    <input type='file' accept='text/plain' onchange='openFile(event)'><br>

    <div id="display"></div>
    <div id="picksDisplay">
    </div>

    </body>
    </html>